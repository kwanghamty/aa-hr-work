<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>ระบบลางานออนไลน์</title>
    <style>
      body {
        background-color: #eaf4fb;
        font-family: 'Sarabun', sans-serif;
        margin: 0;
        padding: 20px;
      }
      .container {
        background: white;
        max-width: 600px;
        margin: auto;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      }
      h2 {
        text-align: center;
        color: #4a90e2;
      }
      label {
        margin-top: 15px;
        display: block;
        font-weight: 500;
      }
      select, input[type="date"], input[type="email"] {
        width: 100%;
        padding: 10px;
        border: 1px solid #cce0f5;
        border-radius: 6px;
        font-size: 16px;
        margin-top: 5px;
      }
      button {
        margin-top: 25px;
        width: 100%;
        padding: 12px;
        background-color: #4a90e2;
        border: none;
        border-radius: 6px;
        color: white;
        font-size: 18px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h2>ระบบลางานออนไลน์</h2>
      <form id="leaveForm">
        <label>ชื่อ-นามสกุล พนักงาน</label>
        <select name="fullname" required>
          <option value="">-- กรุณาเลือก --</option>
          <option>อารีวรรณ แก้วดวงดี</option>
          <option>อัจฉริยาพร เอียงประยูร</option>
          <option>อินทิรา อินทรโสภา</option>
          <option>พิยดา วงค์กระโซ่</option>
          <option>สุภาวิณี ปิตะสุทธิ์</option>
          <option>นิชธิมา คุณากรโยธิน</option>
          <option>เมทินี สาระคง</option>
          <option>ธนรัชต์ เผื่อนปฐม</option>
          <option>อรนิจ ศรีธนะ</option>
          <option>ภาสกร หนูเทพ</option>
          <option>อวิรุธธิ์ คงเอี้ยง</option>
          <option>กรวิก พุ่มโพธิ์</option>
        </select>

        <label>Email พนักงาน</label>
        <select name="email" required>
          <option value="">-- กรุณาเลือก --</option>
          <option>areewan.aapg@gmail.com</option>
          <option>adchriyaporn.aapg@gmail.com</option>
          <option>inthira.aapg@gmail.com</option>
          <option>phityada.aapg@gmail.com</option>
          <option>supavinee.aapg@gmail.com</option>
          <option>nichtima.aapg@gmail.com</option>
          <option>methinee.aapg@gmail.com</option>
          <option>thanarat.aapg@gmail.com</option>
          <option>oranij.aapg@gmail.com</option>
        </select>

        <label>ประเภทการลา</label>
        <select name="leavetype" required>
          <option value="">-- กรุณาเลือก --</option>
          <option>ลาป่วย-มีใบรับรองแพทย์</option>
          <option>ลาป่วย-ไม่มีใบรับรองแพทย์</option>
          <option>ลากิจ</option>
          <option>ลาพักร้อน</option>
          <option>อื่นๆ</option>
        </select>

        <label>วันที่เริ่มลา</label>
        <input type="date" name="startdate" required>

        <label>วันที่สิ้นสุดลา</label>
        <input type="date" name="enddate" required>

        <button type="submit">ส่งข้อมูล</button>
      </form>

      <p id="response" style="color: green; text-align: center; margin-top: 15px;"></p>
    </div>

    <script>
      const form = document.getElementById("leaveForm");
      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const formData = new FormData(form);
        const params = new URLSearchParams();
        for (const pair of formData.entries()) {
          params.append(pair[0], pair[1]);
        }

        const response = await fetch("https://script.google.com/macros/s/AKfycbwNreUtTPaeTXcxY34tiNzG0BH-B1CGA4JT5ChrzRqZ3-m0QeW5EWP86p5RQUkLCTqS/exec", {
          method: "POST",
          body: params,
        });

        if (response.ok) {
          document.getElementById("response").textContent = "ส่งข้อมูลเรียบร้อยแล้ว ✅";
          form.reset();
        } else {
          document.getElementById("response").textContent = "เกิดข้อผิดพลาดในการส่งข้อมูล ❌";
        }
      });
    </script>
  </body>
</html>
